(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("ebnf",function(t){var a={slash:0,parenthesis:1};var r={comment:0,_string:1,characterClass:2};var c=null;if(t.bracesMode)c=e.getMode(t,t.bracesMode);return{startState:function(){return{stringType:null,commentType:null,braced:0,lhs:true,localState:null,stack:[],inDefinition:false}},token:function(t,n){if(!t)return;if(n.stack.length===0){if(t.peek()=='"'||t.peek()=="'"){n.stringType=t.peek();t.next();n.stack.unshift(r._string)}else if(t.match(/^\/\*/)){n.stack.unshift(r.comment);n.commentType=a.slash}else if(t.match(/^\(\*/)){n.stack.unshift(r.comment);n.commentType=a.parenthesis}}switch(n.stack[0]){case r._string:while(n.stack[0]===r._string&&!t.eol()){if(t.peek()===n.stringType){t.next();n.stack.shift()}else if(t.peek()==="\\"){t.next();t.next()}else{t.match(/^.[^\\\"\']*/)}}return n.lhs?"property string":"string";case r.comment:while(n.stack[0]===r.comment&&!t.eol()){if(n.commentType===a.slash&&t.match(/\*\//)){n.stack.shift();n.commentType=null}else if(n.commentType===a.parenthesis&&t.match(/\*\)/)){n.stack.shift();n.commentType=null}else{t.match(/^.[^\*]*/)}}return"comment";case r.characterClass:while(n.stack[0]===r.characterClass&&!t.eol()){if(!(t.match(/^[^\]\\]+/)||t.match(/^\\./))){n.stack.shift()}}return"operator"}var s=t.peek();if(c!==null&&(n.braced||s==="{")){if(n.localState===null)n.localState=e.startState(c);var i=c.token(t,n.localState),l=t.current();if(!i){for(var f=0;f<l.length;f++){if(l[f]==="{"){if(n.braced===0){i="matchingbracket"}n.braced++}else if(l[f]==="}"){n.braced--;if(n.braced===0){i="matchingbracket"}}}}return i}switch(s){case"[":t.next();n.stack.unshift(r.characterClass);return"bracket";case":":case"|":case";":t.next();return"operator";case"%":if(t.match("%%")){return"header"}else if(t.match(/[%][A-Za-z]+/)){return"keyword"}else if(t.match(/[%][}]/)){return"matchingbracket"}break;case"/":if(t.match(/[\/][A-Za-z]+/)){return"keyword"}case"\\":if(t.match(/[\][a-z]+/)){return"string-2"}case".":if(t.match(".")){return"atom"}case"*":case"-":case"+":case"^":if(t.match(s)){return"atom"}case"$":if(t.match("$$")){return"builtin"}else if(t.match(/[$][0-9]+/)){return"variable-3"}case"<":if(t.match(/<<[a-zA-Z_]+>>/)){return"builtin"}}if(t.match(/^\/\//)){t.skipToEnd();return"comment"}else if(t.match(/return/)){return"operator"}else if(t.match(/^[a-zA-Z_][a-zA-Z0-9_]*/)){if(t.match(/(?=[\(.])/)){return"variable"}else if(t.match(/(?=[\s\n]*[:=])/)){return"def"}return"variable-2"}else if(["[","]","(",")"].indexOf(t.peek())!=-1){t.next();return"bracket"}else if(!t.eatSpace()){t.next()}return null}}});e.defineMIME("text/x-ebnf","ebnf")});