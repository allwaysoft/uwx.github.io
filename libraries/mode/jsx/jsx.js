(function(t){if(typeof exports=="object"&&typeof module=="object")t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],t);else t(CodeMirror)})(function(t){"use strict";function e(t,e,n,i){this.state=t;this.mode=e;this.depth=n;this.prev=i}function n(i){return new e(t.copyState(i.mode,i.state),i.mode,i.depth,i.prev&&n(i.prev))}t.defineMode("jsx",function(i,r){var a=t.getMode(i,{name:"xml",allowMissing:true,multilineTagIndentPastTag:false});var s=t.getMode(i,r&&r.base||"javascript");function o(t){var e=t.tagName;t.tagName=null;var n=a.indent(t,"");t.tagName=e;return n}function c(t,e){if(e.context.mode==a)return f(t,e,e.context);else return p(t,e,e.context)}function f(n,r,f){if(f.depth==2){if(n.match(/^.*?\*\//))f.depth=1;else n.skipToEnd();return"comment"}if(n.peek()=="{"){a.skipAttribute(f.state);var p=o(f.state),u=f.state.context;if(u&&n.match(/^[^>]*>\s*$/,false)){while(u.prev&&!u.startOfLine)u=u.prev;if(u.startOfLine)p-=i.indentUnit;else if(f.prev.state.lexical)p=f.prev.state.lexical.indented}else if(f.depth==1){p+=i.indentUnit}r.context=new e(t.startState(s,p),s,0,r.context);return null}if(f.depth==1){if(n.peek()=="<"){a.skipAttribute(f.state);r.context=new e(t.startState(a,o(f.state)),a,0,r.context);return null}else if(n.match("//")){n.skipToEnd();return"comment"}else if(n.match("/*")){f.depth=2;return c(n,r)}}var d=a.token(n,f.state),l=n.current(),x;if(/\btag\b/.test(d)){if(/>$/.test(l)){if(f.state.context)f.depth=0;else r.context=r.context.prev}else if(/^</.test(l)){f.depth=1}}else if(!d&&(x=l.indexOf("{"))>-1){n.backUp(l.length-x)}return d}function p(n,i,r){if(n.peek()=="<"&&s.expressionAllowed(n,r.state)){s.skipExpression(r.state);i.context=new e(t.startState(a,s.indent(r.state,"")),a,0,i.context);return null}var o=s.token(n,r.state);if(!o&&r.depth!=null){var c=n.current();if(c=="{"){r.depth++}else if(c=="}"){if(--r.depth==0)i.context=i.context.prev}}return o}return{startState:function(){return{context:new e(t.startState(s),s)}},copyState:function(t){return{context:n(t.context)}},token:c,indent:function(t,e,n){return t.context.mode.indent(t.context.state,e,n)},innerMode:function(t){return t.context}}},"xml","javascript");t.defineMIME("text/jsx","jsx");t.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:true}})});