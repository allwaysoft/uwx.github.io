(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("tiddlywiki",function(){var e={};var t={allTags:true,closeAll:true,list:true,newJournal:true,newTiddler:true,permaview:true,saveChanges:true,search:true,slider:true,tabs:true,tag:true,tagging:true,tags:true,tiddler:true,timeline:true,today:true,version:true,option:true,"with":true,filter:true};var r=/[\w_\-]/i,n=/^\-\-\-\-+$/,i=/^\/\*\*\*$/,u=/^\*\*\*\/$/,a=/^<<<$/,f=/^\/\/\{\{\{$/,o=/^\/\/\}\}\}$/,c=/^<!--\{\{\{-->$/,l=/^<!--\}\}\}-->$/,m=/^\{\{\{$/,s=/^\}\}\}$/,h=/.*?\}\}\}/;function k(e,t,r){t.tokenize=r;return r(e,t)}function d(t,s){var h=t.sol(),d=t.peek();s.block=false;if(h&&/[<\/\*{}\-]/.test(d)){if(t.match(m)){s.block=true;return k(t,s,w)}if(t.match(a))return"quote";if(t.match(i)||t.match(u))return"comment";if(t.match(f)||t.match(o)||t.match(c)||t.match(l))return"comment";if(t.match(n))return"hr"}t.next();if(h&&/[\/\*!#;:>|]/.test(d)){if(d=="!"){t.skipToEnd();return"header"}if(d=="*"){t.eatWhile("*");return"comment"}if(d=="#"){t.eatWhile("#");return"comment"}if(d==";"){t.eatWhile(";");return"comment"}if(d==":"){t.eatWhile(":");return"comment"}if(d==">"){t.eatWhile(">");return"quote"}if(d=="|")return"header"}if(d=="{"&&t.match(/\{\{/))return k(t,s,w);if(/[hf]/i.test(d)&&/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return"link";if(d=='"')return"string";if(d=="~")return"brace";if(/[\[\]]/.test(d)&&t.match(d))return"brace";if(d=="@"){t.eatWhile(r);return"link"}if(/\d/.test(d)){t.eatWhile(/\d/);return"number"}if(d=="/"){if(t.eat("%")){return k(t,s,b)}else if(t.eat("/")){return k(t,s,v)}}if(d=="_"&&t.eat("_"))return k(t,s,$);if(d=="-"&&t.eat("-")){if(t.peek()!=" ")return k(t,s,x);if(t.peek()==" ")return"brace"}if(d=="'"&&t.eat("'"))return k(t,s,p);if(d=="<"&&t.eat("<"))return k(t,s,z);t.eatWhile(/[\w\$_]/);return e.propertyIsEnumerable(t.current())?"keyword":null}function b(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=d;break}r=n=="%"}return"comment"}function p(e,t){var r=false,n;while(n=e.next()){if(n=="'"&&r){t.tokenize=d;break}r=n=="'"}return"strong"}function w(e,t){var r=t.block;if(r&&e.current()){return"comment"}if(!r&&e.match(h)){t.tokenize=d;return"comment"}if(r&&e.sol()&&e.match(s)){t.tokenize=d;return"comment"}e.next();return"comment"}function v(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=d;break}r=n=="/"}return"em"}function $(e,t){var r=false,n;while(n=e.next()){if(n=="_"&&r){t.tokenize=d;break}r=n=="_"}return"underlined"}function x(e,t){var r=false,n;while(n=e.next()){if(n=="-"&&r){t.tokenize=d;break}r=n=="-"}return"strikethrough"}function z(e,r){if(e.current()=="<<"){return"macro"}var n=e.next();if(!n){r.tokenize=d;return null}if(n==">"){if(e.peek()==">"){e.next();r.tokenize=d;return"macro"}}e.eatWhile(/[\w\$_]/);return t.propertyIsEnumerable(e.current())?"keyword":null}return{startState:function(){return{tokenize:d}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r}}});e.defineMIME("text/x-tiddlywiki","tiddlywiki")});