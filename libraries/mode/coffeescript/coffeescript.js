(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("coffeescript",function(e,t){var r="error";function n(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var i=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var f=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var o=/^[_A-Za-z$][_A-Za-z$0-9]*/;var a=/^@[_A-Za-z$][_A-Za-z$0-9]*/;var c=n(["and","or","not","is","isnt","in","instanceof","typeof"]);var s=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var u=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var p=n(s.concat(u));s=n(s);var l=/^('{3}|\"{3}|['\"])/;var d=/^(\/{3}|\/)/;var v=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var h=n(v);function m(e,t){if(e.sol()){if(t.scope.align===null)t.scope.align=false;var n=t.scope.offset;if(e.eatSpace()){var s=e.indentation();if(s>n&&t.scope.type=="coffee"){return"indent"}else if(s<n){return"dedent"}return null}else{if(n>0){b(e,t)}}}if(e.eatSpace()){return null}var u=e.peek();if(e.match("####")){e.skipToEnd();return"comment"}if(e.match("###")){t.tokenize=y;return t.tokenize(e,t)}if(u==="#"){e.skipToEnd();return"comment"}if(e.match(/^-?[0-9\.]/,false)){var v=false;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){v=true}if(e.match(/^-?\d+\.\d*/)){v=true}if(e.match(/^-?\.\d+/)){v=true}if(v){if(e.peek()=="."){e.backUp(1)}return"number"}var m=false;if(e.match(/^-?0x[0-9a-f]+/i)){m=true}if(e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){m=true}if(e.match(/^-?0(?![\dx])/i)){m=true}if(m){return"number"}}if(e.match(l)){t.tokenize=k(e.current(),false,"string");return t.tokenize(e,t)}if(e.match(d)){if(e.current()!="/"||e.match(/^.*\//,false)){t.tokenize=k(e.current(),true,"string-2");return t.tokenize(e,t)}else{e.backUp(1)}}if(e.match(i)||e.match(c)){return"operator"}if(e.match(f)){return"punctuation"}if(e.match(h)){return"atom"}if(e.match(a)||t.prop&&e.match(o)){return"property"}if(e.match(p)){return"keyword"}if(e.match(o)){return"variable"}e.next();return r}function k(e,n,i){return function(f,o){while(!f.eol()){f.eatWhile(/[^'"\/\\]/);if(f.eat("\\")){f.next();if(n&&f.eol()){return i}}else if(f.match(e)){o.tokenize=m;return i}else{f.eat(/['"\/]/)}}if(n){if(t.singleLineStringErrors){i=r}else{o.tokenize=m}}return i}}function y(e,t){while(!e.eol()){e.eatWhile(/[^#]/);if(e.match("###")){t.tokenize=m;break}e.eatWhile("#")}return"comment"}function g(t,r,n){n=n||"coffee";var i=0,f=false,o=null;for(var a=r.scope;a;a=a.prev){if(a.type==="coffee"||a.type=="}"){i=a.offset+e.indentUnit;break}}if(n!=="coffee"){f=null;o=t.column()+t.current().length}else if(r.scope.align){r.scope.align=false}r.scope={offset:i,type:n,prev:r.scope,align:f,alignOffset:o}}function b(e,t){if(!t.scope.prev)return;if(t.scope.type==="coffee"){var r=e.indentation();var n=false;for(var i=t.scope;i;i=i.prev){if(r===i.offset){n=true;break}}if(!n){return true}while(t.scope.prev&&t.scope.offset!==r){t.scope=t.scope.prev}return false}else{t.scope=t.scope.prev;return false}}function z(e,t){var n=t.tokenize(e,t);var i=e.current();if(i==="return"){t.dedent=true}if((i==="->"||i==="=>")&&e.eol()||n==="indent"){g(e,t)}var f="[({".indexOf(i);if(f!==-1){g(e,t,"])}".slice(f,f+1))}if(s.exec(i)){g(e,t)}if(i=="then"){b(e,t)}if(n==="dedent"){if(b(e,t)){return r}}f="])}".indexOf(i);if(f!==-1){while(t.scope.type=="coffee"&&t.scope.prev)t.scope=t.scope.prev;if(t.scope.type==i)t.scope=t.scope.prev}if(t.dedent&&e.eol()){if(t.scope.type=="coffee"&&t.scope.prev)t.scope=t.scope.prev;t.dedent=false}return n}var x={startState:function(e){return{tokenize:m,scope:{offset:e||0,type:"coffee",prev:null,align:false},prop:false,dedent:0}},token:function(e,t){var r=t.scope.align===null&&t.scope;if(r&&e.sol())r.align=false;var n=z(e,t);if(n&&n!="comment"){if(r)r.align=true;t.prop=n=="punctuation"&&e.current()=="."}return n},indent:function(e,t){if(e.tokenize!=m)return 0;var r=e.scope;var n=t&&"])}".indexOf(t.charAt(0))>-1;if(n)while(r.type=="coffee"&&r.prev)r=r.prev;var i=n&&r.type===t.charAt(0);if(r.align)return r.alignOffset-(i?1:0);else return(i?r.prev:r).offset},lineComment:"#",fold:"indent"};return x});e.defineMIME("text/x-coffeescript","coffeescript");e.defineMIME("text/coffeescript","coffeescript")});