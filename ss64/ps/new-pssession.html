<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="New-PSSession 
Create a persistent connection to a local or remote computer.
Syntax
      New-PSSession [[-ComputerName] string[]] [-ApplicationName string]
         [-Authentication AuthenticationMec">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/ps/new-pssession.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="New-PSSession 
Create a persistent connection to a local or remote computer.
Syntax
      New-PSSession [[-ComputerName] string[]] [-ApplicationName string]
         [-Authentication AuthenticationMec">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:00:38.047Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="New-PSSession 
Create a persistent connection to a local or remote computer.
Syntax
      New-PSSession [[-ComputerName] string[]] [-ApplicationName string]
         [-Authentication AuthenticationMec">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_ps.lbi" --><!-- #EndLibraryItem --><h1>New-PSSession</h1> 
<p>Create a persistent connection to a local or remote computer.</p>
<pre>Syntax
      New-PSSession [[-ComputerName] <i>string</i>[]] [-ApplicationName <i>string</i>]
         [-Authentication <i>AuthenticationMechanism</i>] [-ConfigurationName <i>string</i>]
            [-CertificateThumbprint <i>string</i>] [-Credential <i>PSCredential</i>] 
               [-Name <i>string</i>[]] [-Port <i>int</i>] [-SessionOption <i>PSSessionOption</i>]
                   [-UseSSL] [-ThrottleLimit <i>int</i>] [<i>CommonParameters</i>]<br>    <br>      New-PSSession [[-Session] <i>PSSession</i>[]] [-Name <i>string</i>[]]
         [-ThrottleLimit <i>int</i>] [<i>CommonParameters</i>]<br>    <br>      New-PSSession [-ConnectionURI] <i>Uri</i>[] [-AllowRedirection]
         [-Authentication <i>AuthenticationMechanism</i>] [-ConfigurationName <i>string</i>]
            [-CertificateThumbprint <i>string</i>] [-Credential <i>PSCredential</i>] 
               [-Name <i>string</i>[]] [-SessionOption <i>PSSessionOption</i>]
                   [-ThrottleLimit <i>int</i>] [<i>CommonParameters</i>]
<p>Key<br>
-AllowRedirection<br>
Allow redirection of this connection to an alternate Uniform Resource Identifier (URI).</p>
<pre><code>   By default, PowerShell does not redirect connections.
   To also limit the number of times that the connection is redirected, set the
   MaximumConnectionRedirectionCount property of the $PSSessionOption preference variable, or
   the MaximumConnectionRedirectionCount property of the value of the SessionOption parameter.
   The default value is 5.
   For more information, see the description of the SessionOption parameter, and see New-PSSessionOption.
</code></pre>
<p>-ApplicationName <i>string</i><br>
The application name segment of the connection URI.<br>
Use this to specify the application name when you are not using -ConnectionURI.</p>
<pre><code>   The default value is the value of the $PSSessionApplicationName preference variable on
   the local computer. If this preference variable is not defined, the default value is &quot;WSMAN&quot;.
   This value is appropriate for most uses. For more see about_Preference_Variables.

   The WinRM service uses the application name to select a listener to service the connection
   request. This name should match the URLPrefix property of a listener on the remote computer.
</code></pre>
<p>-Authentication <i>AuthenticationMechanism</i><br>
The mechanism used to authenticate the user’s credentials:</p>
<pre><code>   &lt;u&gt;Default&lt;/u&gt; | Basic | Negotiate | NegotiateWithImplicitCredential | CredSSP | Digest | Kerberos

   The default value is  &quot;Default&quot;.

   CredSSP authentication is available only in Windows Vista and later versions of Windows.
   For more information about the values of this parameter, see &lt;a href=&quot;http://go.microsoft.com/fwlink/?LinkID=144382&quot;&gt;MSDN&lt;/a&gt;

   Caution: Credential Security Service Provider (CredSSP) authentication,
   in which the user's credentials are passed to a remote computer to be
   authenticated, is designed for commands that require authentication on
   more than one resource, such as accessing a remote network share.
   This mechanism increases the security risk of the remote operation.
   If the remote computer is compromised, the credentials that are passed to
   it can be used to control the network session.
</code></pre>
<p>-CertificateThumbprint <i>string<br>
</i>       The digital public key certificate (X509) of a user account that has permission<br>
to perform this action. Enter the certificate thumbprint of the certificate.</p>
<pre><code>   Certificates are used in client certificate-based authentication.
   They can be mapped only to local user accounts; they do not work with domain accounts. 

   To get a certificate thumbprint, use the Get-Item or Get-ChildItem
   command in the PowerShell Cert: drive.
</code></pre>
<p>-ComputerName <i>string</i>[]<br>
Create a persistent connection (PSSession) to the specified computer.<br>
If you enter multiple computer names, New-PSSession creates multiple PSSessions,<br>
one for each computer. The default is the local computer.</p>
<pre><code>   Type the NetBIOS name, an IP address, or a fully qualified domain name of one
   or more remote computers. To specify the local computer, type the computer name,
   &quot;localhost&quot;, or a dot (.).
   When the computer is in a different domain than the user, the fully qualified
   domain name is required. You can also pipe a computer name (in quotes) to New-PSSession.

   To use an IP address in the value of the ComputerName parameter, the command
   must include the Credential parameter. Also, the computer must be configured
   for HTTPS transport or the IP address of the remote computer must be included in
   the WinRM TrustedHosts list on the local computer.
   For instructions for adding a computer name to  the TrustedHosts list,
   see &quot;How to Add  a Computer to the Trusted Host List&quot; in about_Remote_Troubleshooting.

   Note:  In Windows Vista and later versions of Windows, to include the local
   computer in the value of the ComputerName parameter, you must start PowerShell
   with the &quot;Run as administrator&quot; option.
</code></pre>
<p>-ConfigurationName <i>string</i><br>
The session configuration that is used for the new PSSession.</p>
<pre><code>   Enter a configuration name or the fully qualified resource Uniform Resource
   Identifier (URI) for a session configuration. If you specify only the configuration
   name, the following schema URI is prepended:  http://schemas.microsoft.com/powershell.

   The session configuration for a session is located on the remote computer.
   If the specified session configuration does not exist on the remote computer,
   the command fails.

   The default value is the value of the $PSSessionConfigurationName preference variable
   on the local computer. If this preference variable is not set, the default is
   Microsoft.PowerShell. For more information, see about_Preference_Variables.
</code></pre>
<p>-ConnectionURI <i>Uri</i>[]<br>
A Uniform Resource Identifier (URI) that defines the connection endpoint.<br>
The URI must be fully qualified.</p>
<pre><code>   The format of this string is as follows: 
      &lt;i&gt;Transport&lt;/i&gt;://&lt;i&gt;ComputerName&lt;/i&gt;:&lt;i&gt;Port&lt;/i&gt;/&lt;i&gt;ApplicationName&lt;/i&gt;

   The default value is as follows:
        http://localhost:80/WSMAN
   Valid values for the Transport segment of the URI are HTTP and HTTPS.
   If you do not specify a ConnectionURI, you can use the UseSSL, ComputerName,
   Port, and ApplicationName parameters to specify the URI values.

   If the destination computer redirects the connection to a different URI, 
   PowerShell prevents the redirection unless you use -AllowRedirection in the command.

-Credential &lt;i&gt;PSCredential&lt;/i&gt;
   A user account that has permission to perform this action.
   The default is the current user.

   Type a user name, such as &quot;User01&quot;, &quot;Domain01\User01&quot;, or &quot;User@Domain.com&quot;, or
   enter a PSCredential object, such as one returned by &lt;a href=&quot;get-credential.html&quot;&gt;Get-Credential&lt;/a&gt;. 

   When you type a user name, you will be prompted for a password.
</code></pre>
<p>-Name <i>string</i>[]<br>
A friendly name for the PSSession.</p>
<pre><code>   You can use this name to refer to the PSSession when using other cmdlets,
   such as Get-PSSession and Enter-PSSession.

   The name is not required to be unique to the computer or the current session.
</code></pre>
<p>-Port <i>int</i><br>
The network port  on the remote computer that is used for this command.<br>
The default is port 80 (the HTTP port).</p>
<pre><code>   Before using an alternate port, you must configure the WinRM listener on
   the remote computer to listen at that port.
   Use the following commands to configure the listener:

    1. winrm delete winrm/config/listener?Address=*+Transport=HTTP
    2. winrm create winrm/config/listener?Address=*+Transport=HTTP @{Port=&quot;&amp;lt;port-number&amp;gt;&quot;;}

   Do not use the Port parameter unless you must. The port setting in the
   command applies to all computers and sessions in which the command runs.
   An alternate port setting might prevent the command from running on all computers.
</code></pre>
<p>-Session <i>PSSession</i>[]<br>
Use the specified PSSession as a model for the new PSSession.<br>
This parameter creates new PSSessions with the same properties as the specified PSSessions.</p>
<pre><code>   Enter a variable that contains the PSSessions or a command that creates or
   gets the PSSessions, such as a New-PSSession or Get-PSSession command.

   The resulting PSSessions have the same computer name, application name,
   connection URI, port, configuration name, throttle limit, and Secure Sockets Layer (SSL)
   value as the originals, but they have a different display name, ID, and instance ID (GUID).
</code></pre>
<p>-SessionOption <i>PSSessionOption</i><br>
Set advanced options for the session.<br>
Enter a SessionOption object that you create by using the New-PSSession Option cmdlet.</p>
<pre><code>   The default values for the options are determined by the value of
   the $PSSessionOption preference variable, if it is set.
   Otherwise, the session uses the system defaults.

   For a description of the session options, including the default values,
   see &lt;a href=&quot;new-pssessionoption.html&quot;&gt;New-PSSessionOption&lt;/a&gt;.
   For information about the $PSSessionOption preference variable, see about_Preference_Variables.
</code></pre>
<p>-ThrottleLimit <i>int</i><br>
The maximum number of concurrent connections that can be established<br>
to run this command. If you omit this parameter or enter a value of 0 (zero),<br>
the default value, 32, is used.</p>
<pre><code>   The throttle limit applies only to the current command, not to the session or to the computer.
</code></pre>
<p>-UseSSL<br>
Use the Secure Sockets Layer (SSL) protocol to establish a connection to the<br>
remote computer. By default, SSL is not used.</p>
<pre><code>   WS-Management encrypts all Windows PowerShell content transmitted over the
   network. UseSSL is an additional protection that sends the data across an HTTPS
   connection instead of an HTTP connection.

   If you use this parameter, but SSL is not available on the port used for the command,
   the command fails.
</code></pre>
<p><a href="common.html">CommonParameters</a>:<br>
-Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,<br>
-OutBuffer -OutVariable.</p></pre><p></p>
<p>Standard <a href="get-alias.html">Aliases</a> for New-PSSession:<span class="code"> nsn</span></p>
<p>New-PSSession  creates a  PowerShell session (PSSession) on a local or remote computer.  When you 
create a PSSession,  PowerShell establishes a persistent connection to the remote computer. <br>
<br>
Use a PSSession to run multiple commands that share data, such as a function or the value of a variable. To run commands in a PSSession, use <a href="invoke-command.html">Invoke-Command</a>. To use the PSSession to interact directly with a remote computer, use <a href="enter-pssession.html">Enter-PSSession</a> . For more information, see <a href="get-help.html">help</a> about_PSSessions.<br>
<br>
You can run commands on a remote computer without creating a PSSession by using the <span class="code">-ComputerName</span> parameter of <a href="enter-pssession.html">Enter-PSSession</a> or <a href="invoke-command.html">Invoke-Command</a>. When you use <span class="code">-ComputerName</span> ,  PowerShell creates a temporary connection that is used for the interactive session or for a single command and is then closed.</p>
<p><b>Examples</b></p>
<p>Create a new PSSession on the local computer and save the PSSession in the $sess variable: </p>
<pre>PS C:&gt; $sess = new-pssession</pre>
<p>Create a new PSSession on  Server64 and save it in the $s64 variable: </p>
<pre>PS C:&gt; $s64 = new-pssession -ComputerName Server64</pre>
<p>Create a new PSSession on  Server65 and server66 and save the sessions to 2 variables: </p>
<p class="code">PS C:&gt; $s65, $s66 = new-session -computername server65,server66</p>
<p>Create a new PSSession on Server64 and use the SSL protocol with an alternate session configuration called 'DBA1' then connect via server port 8081:</p>
<pre>PS C:&gt; new-pssession -computername Server64 -port 8081 -useSSL -ConfigurationName DBA1</pre>
<p>Create a new PSSession with the same properties as an existing PSSession. This can be useful when the <a href="../nt/syntax-desktopheap.html">resources</a> of an existing PSSession are exhausted: </p>
<pre>PS C:&gt; new-pssession -session $s -credential domain01\user01</pre>
<p>Create  a PSSession calles <span class="code">$sess</span> with a global scope on a computer in a different domain: </p>
<pre>PS C:&gt; $global:sess = new-pssession -computername server64.dom24.ss64.com -credential domain01\admin01</pre>
<p>Create a PSSession on each of the 200 computers listed in the Servers.txt file and  store the resulting PSSession in the $rs variable, this syntax can also be used with spreadsheets and databases: </p>
<pre>PS C:&gt; $rs = get-content c:\servers.txt | new-PSsession -throttleLimit 50</pre>
<p>Create a PSSession and store it in the $sess variable, specify the transport protocol (http), the remote computer (Server64), the port (91), and an alternate session configuration: </p>
<pre>PS C:&gt; $sess = new-PSSession -URI http://Server64:91/NewSession -credential domain01\user01</pre>
<p>Create  a set of PSSessions and then run a background job in each: </p>
<pre>PS C:&gt; $sess = new-PSSession -computername (import-csv servers.csv) -credential domain01\admin01 -throttlelimit 16
<p>PS C:&gt; invoke-command -session $sess -scriptblock {get-process powershell} -AsJob</p></pre><p></p>
<p>Create a new PSSession that connects to a computer specified with a URI: </p>
<pre>PS C:&gt; new-PSSession -ConnectionURI https://management.exchangelabs.com/Management</pre>
<p class="quote"><i>“We never fully grasp the import of any true statement until we have a clear notion of what the opposite untrue statement would be” ~ William James</i></p>
<p><b>Related:</b></p>
<p><a href="remove-pssession.html">Remove-PSSession</a> -     Close PowerShell session(s)<br>
<a href="enter-pssession.html">Enter-PSSession</a> - Start an interactive session with a remote computer<br>
<a href="export-pssession.html">Export-PSSession</a> - Import commands and save them in a PowerShell module</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p>
<!-- PowerShell300 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="6253539900"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id="bl" class="footer"><a href="new-pssession.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2016<br>
Some rights reserved</div><!-- #EndLibraryItem -->

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/ps/new-pssession.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>