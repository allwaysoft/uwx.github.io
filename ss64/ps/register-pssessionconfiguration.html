<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Register-PSSessionConfiguration 
Create and register a new PS session configuration.
This is an advanced cmdlet for system administrators to manage custom session configurations for their users.
Synta">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/ps/register-pssessionconfiguration.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="Register-PSSessionConfiguration 
Create and register a new PS session configuration.
This is an advanced cmdlet for system administrators to manage custom session configurations for their users.
Synta">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:00:38.066Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="Register-PSSessionConfiguration 
Create and register a new PS session configuration.
This is an advanced cmdlet for system administrators to manage custom session configurations for their users.
Synta">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_ps.lbi" --><!-- #EndLibraryItem --><h1>Register-PSSessionConfiguration</h1> 
<p>Create and register a new PS session configuration.<br>
This is an advanced cmdlet for system administrators to manage custom session configurations for their users.</p>
<pre>Syntax
      Register-PSSessionConfiguration [-Name] <i>string</i> [-Force] 
         [-AssemblyName] <i>string</i> [-ConfigurationTypeName] <i>string</i> 
            [-ApplicationBase <i>string</i>] [-MaximumReceivedDataSizePerCommandMB <i>double</i>]
               [-MaximumReceivedObjectSizeMB <i>double</i>] [-NoServiceRestart]
                  [-ProcessorArchitecture <i>string</i>] [-SecurityDescriptorSDDL <i>string</i>]
                     [-ShowSecurityDescriptorUI] [-StartupScript <i>string</i>]
                        [-ThreadApartmentState {STA | MTA | <u>Unknown</u>}]
                           [-ThreadOptions {Default | UseNewThread | ReuseThread | UseCurrentThread}]
                              [-Confirm] [-WhatIf] [<i>CommonParameters</i>]
<p>Key<br>
-Name <i>string</i><br>
A name for the session configuration. This parameter is required.</p>
<p>-ApplicationBase<br>
The path to the assembly file (*.dll) that is specified in the value of -AssemblyName.<br>
Use this parameter when the value of the AssemblyName parameter does not include a path.<br>
The default is the current directory.</p>
<p>-AssemblyName<br>
The name of an assembly file (*.dll) in which the configuration type is defined.<br>
You can specify the path to the .dll in this parameter or in the value of -ApplicationBase.</p>
<pre><code>   This parameter is required when -ConfigurationTypeName is specified.
    
-ConfigurationTypeName &lt;i&gt;string&lt;/i&gt;
   The fully qualified name of the Microsoft .NET Framework type that is used for this configuration. 
   The type that you specify must implement the
      System.Management.Automation.Remoting.PSSessionConfiguration class.
    
   To specify the assembly file (.dll) that implements the configuration type, use -AssemblyName
   and -AssemblyBase parameters.
    
   Creating a type allows you to control more aspects of the session configuration, such as
   exposing or hiding certain parameters of cmdlets, or setting data size and object size limits
   that users cannot override. 
    
   If you omit this parameter, the DefaultRemotePowerShellConfiguration class is used for
   the session configuration.
</code></pre>
<p>-Force<br>
Suppress all user prompts and restart the WinRM service without prompting.<br>
Restarting the service makes the configuration change effective.</p>
<pre><code>   To prevent a restart and suppress the restart prompt, use -NoServiceRestart.
</code></pre>
<p>-MaximumReceivedDataSizePerCommandMB double<br>
Limit the amount of data that can be sent to this computer in any single remote command.<br>
Enter the data size in megabytes (MB). The default is 50 MB.</p>
<pre><code>   If a data size limit is defined in the configuration type that is specified in
   -ConfigurationTypeName, the limit in the configuration type is used and the value of
   this parameter is ignored.
</code></pre>
<p>-MaximumReceivedObjectSizeMB <i>double</i><br>
Limit the amount of data that can be sent to this computer in any single object.<br>
Enter the data size in megabytes (MB). The default is 10 MB.</p>
<pre><code>   If an object size limit is defined in the configuration type that is specified
   in -ConfigurationTypeName, the limit in the configuration type is used and the value of
   this parameter is ignored.
</code></pre>
<p>-NoServiceRestart<br>
Do not restart the WinRM service and suppress the prompt to restart the service.</p>
<pre><code>   By default, when you enter a Register-PSSessionConfiguration command, you are prompted to
   restart the WinRM service to make the new session configuration effective.
   Until the WinRM service is restarted, the new session configuration is not effective.
    
   To restart the WinRM service without prompting, use -Force.
   To restart the WinRM service manually, use &lt;a href=&quot;restart-service.html&quot;&gt;Restart-Service&lt;/a&gt;.
</code></pre>
<p>-ProcessorArchitecture <i>string</i><br>
A processor architecture for the configuration.<br>
This value determines whether a 32-bit or 64-bit version of the process that hosts<br>
PowerShell is started when the configuration is used.<br>
Valid values are x86, AMD64, and IA64.</p>
<pre><code>   The default is determined by the processor architecture of the computer that hosts
   the session configuration.
</code></pre>
<p>-SecurityDescriptorSDDL <i>string</i><br>
A Security Descriptor Definition Language (SDDL) string for the configuration.</p>
<pre><code>   This string determines the permissions that are required to use the new session configuration.
   To use a session configuration in a session, users must have at least &quot;Execute(Invoke)&quot;
   permission for the configuration.
    
   If the security descriptor is complex, consider using the ShowSecurityDescriptorUI parameter
   instead of this parameter. You cannot use both parameters in the same command.
    
   If you omit this parameter, the root SDDL for the WinRM service is used for this configuration.
   To view or change the root SDDL, use the WS-Management provider.
   For example &quot;get-item wsman:\localhost\service\rootSDDL&quot;.
   For more information about the WS-Management provider, type &quot;get-help wsman&quot;.
</code></pre>
<p>-ShowSecurityDescriptorUI<br>
Display a property sheet that help create the SDDL for the session configuration.<br>
The property sheet appears after you run Register-PSSessionConfiguration and restart the WinRM service.</p>
<pre><code>   When setting the permissions for the configuration, remember that users must have at
   least &quot;Execute(Invoke)&quot; permission to use the session configuration in a session.
    
   You cannot use -SecurityDescriptorSDDL and -ShowSecurityDescriptorUI in the same command.
</code></pre>
<p>-StartupScript <i>string</i><br>
The fully qualified path to a Windows PowerShell script. The specified script runs in<br>
the new session that uses the session configuration.</p>
<pre><code>   You can use the script to further configure the session. If the script generates an error
   (even a non-terminating error), the session is not created and the user's New-PSSession command fails.
</code></pre>
<p>-ThreadApartmentState {STA | MTA | <u>Unknown</u>}<br>
The apartment state for threads in the session.</p>
<p>-ThreadOptions <i>PSThreadOptions</i><br>
Define how threads are created and used when a command is executed in the session.<br>
Valid values are Default, ReuseThread, UseCurrentThread, and UseNewThread.<br>
UseCurrentThread is the default.</p>
<p>-confirm<br>
Prompt for confirmation before executing the command.</p>
<p>-whatIf<br>
Describe what would happen if you executed the command without actually<br>
executing the command.</p>
<p><a href="common.html">CommonParameters</a>:<br>
-Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,<br>
-OutBuffer -OutVariable.</p></pre><p></p>
<p> Every Windows PowerShell remote session uses a session configuration. When users create a session that connects to 
the computer, they can select a configuration or use the default configurations that are registered when you enable
Windows PowerShell remoting. Users can also set the $PSSessionConfigurationName preference variable, which specifies a default configuration for sessions created in the current session. <br>
<br>
The session configuration configures the environment for the session. You can define the configuration by using an 
assembly that implements a new configuration class and by using a script that runs in the session. The configuration can determine which commands are available in the session, and it can include settings that protect the computer,
such as those that limit the amount of data that the session can receive remotely in a single object or command. 
You can also specify a security descriptor that determines the permissions that are required to use the configuration.</p>
<p><b>Examples</b></p>
<p>Register a  session configuration called SS64, also use -ConfigurationTypeName to specify a new class that further configures the session: </p>
<pre>PS C:&gt; register-pssessionConfiguration -name SS64 -applicationBase c:\ps_cfg\ -assemblyName SS64.dll -configurationTypeName SS64</pre>
<p>Register a  configuration called Tortoise on the local computer, and assign a startup script:</p>
<pre>PS C:&gt; register-pssessionConfiguration -name Tortoise -startupScript c:\ps\ss64.ps1</pre>
<p>Register the AdminShell session configuration:</p>
<pre>PS C:&gt; $sddl = "O:NSG:BAD:P(A;;GA;;;BA)S:P(AU;FA;GA;;;WD)(AU;FA;SA;GWGX;;WD)"
PS C:&gt; register-pssessionconfiguration -name AdminShell -securityDescriptorSDDL $sddl _
-maximumReceivedObjectSizeMB 20</pre>
<blockquote>
<p> The first command saves a custom SDDL in the $sddl variable. <br>
<br>
The second command registers the new shell using the SecurityDescritorSDDL parameter to specify the SDDL in the value of the $sddl variable and the MaximumReceivedObjectSizeMB parameter to increase the object size limit. <br>
<br>
As an alternative to using <span class="code">-SecurityDescriptorSDDL</span>, you can use <span class="code">-ShowSecurityDescriptorUI</span>, which displays a property sheet that you can use to set permissions for the session configuration. When you click "OK" in the property sheet, the tool generates an SDDL for the session configuration.</p>
</blockquote>
<p>Use dir (Get-ChildItem) to display Shell configurations, including the two default configurations that come with Windows PowerShell:</p>
<pre>PS C:&gt; dir wsman:\localhost\plugin
</pre>
<p>Creates and register the 'WithProfile' session configuration on the local computer, assign a StartupScript. The content of the specified script, Add-Profile.ps1, is also displayed. The script contains a single command that 
uses <a href="syntax-operators.html#dot">dot sourcing</a> to run the user's CurrentUserAllHosts profile in the current scope of the session.:</p>
<pre>PS C:&gt; register-pssessionconfiguration -name WithProfile -startupScript add-profile.ps1
<pre><code># Add-Profile.ps1&lt;br&gt;    . c:\users\demo1\documents\windowspowershell\profile.ps1&lt;/pre&gt;
</code></pre>
<p class="quote"><i>"All of Western logic is based upon the law of
contradiction - if two things contradict, then
at least one of them is false. But Islamic logic
is dualistic; two things can contradict each
other and both are true" - Bill Warner</i></p>
<p><b>Related:</b></p>
<p><a href="get-pssessionconfiguration.html">Get-PSSessionConfiguration</a> - Get the registered PS session configuration<br>
<a href="unregister-pssessionconfiguration.html">Unregister-PSSessionConfiguration</a> - Delete registered PS session configuration</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p>
<!-- PowerShell300 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="6253539900"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id="bl" class="footer"><a href="register-pssessionconfiguration.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2015<br>
Some rights reserved</div><!-- #EndLibraryItem -->
</pre>
      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/ps/register-pssessionconfiguration.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>