<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="FORFILES.exe (Native command in Vista/Windows7/2008, via Resource Kit for XP)


Select a file (or set of files) and execute a command on each file. Batch processing.
Syntax
      FORFILES [/p Path] [/">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/nt/forfiles.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="FORFILES.exe (Native command in Vista/Windows7/2008, via Resource Kit for XP)


Select a file (or set of files) and execute a command on each file. Batch processing.
Syntax
      FORFILES [/p Path] [/">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:02:51.152Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="FORFILES.exe (Native command in Vista/Windows7/2008, via Resource Kit for XP)


Select a file (or set of files) and execute a command on each file. Batch processing.
Syntax
      FORFILES [/p Path] [/">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_nt.lbi" --><!-- #EndLibraryItem --><h1>FORFILES.exe (Native command in Vista/Windows7/2008, via <a href="../links/windows.html#kits">Resource Kit</a> for XP)
<!--Win NT update ftp://ftp.microsoft.com/ResKit/y2kfix/x86/ -->
</h1>
<p>Select a file (or set of files) and execute a command on each file. Batch processing.</p>
<pre>Syntax
      FORFILES [/p <i>Path</i>] [/<b>m</b><i> SrchMask</i>] [/s] [/<b>c</b><i> Command</i>] [/<b>d</b><i> </i>[+ | -] {<i>date</i> | <i>dd</i>}]   
<p>Key<br>
/p <i>Path</i>      The Path to search  (default=current folder)</p>
<p>/m <i>SrchMask</i>  Select files matching the specified search mask<br>
default = <em>.</em></p>
<p>/s           Recurse into sub-folders</p>
<p>/C <i>command</i>   The command to execute for each file.<br>
Wrap the command string in double quotes.<br>
Default = “cmd /c echo @file”</p>
<pre><code>            The Command variables listed below can also be used in the
            command string.
</code></pre>
<p>/D <i>date</i>      Select files with a last modified date greater than or<br>
equal to (+), or less than or equal to (-),<br>
the specified <i>date</i>, using the region specific date format<br>
typically “MM/DD/yyyy” or “DD/MM/yyyy”</p>
<p>/D + <i>dd</i>      Select files with a last modified date greater than or<br>
equal to the current date plus “dd” days. (in the future)</p>
<p>/D - <i>dd</i>      Select files with a last modified date less than or<br>
equal to the current date minus “dd” days. (in the past)</p>
<pre><code>            A valid &quot;dd&quot; number of days can be any number in
            the range of 0 to 32768.   (89 years)
            &quot;+&quot; is taken as default sign if not specified.
</code></pre>
<p>Command Variables:<br>
@file    The name of the file.<br>
@fname   The file name without extension.<br>
@ext     Only the extension of the file.<br>
@path    Full path of the file.<br>
@relpath Relative path of the file.<br>
@isdir   Returns “TRUE” if a file type is a directory,<br>
and “FALSE” for files.<br>
@fsize   Size of the file in bytes.<br>
@fdate   Last modified date of the file.<br>
@ftime   Last modified time of the file.</p></pre><p></p>
<p> To include <a href="../ascii.html">special characters</a> in the command line, use the hexadecimal code for the character in 0xHH format (ex. 0x09 for tab). <a href="syntax-internal.html">Internal</a> CMD.exe commands should be preceded with "cmd /c".</p>
<h2>Bugs</h2>
<blockquote>
<p>Recent versions of FORFILES contain a bug, in processing command line arguments: running a <span class="code">/c</span>command that contains an argument such as<span class="code"> FORFILES /C "PING -a" </span> <a href="http://stackoverflow.com/a/26990159/1720814" target="_blank" rel="external">will fail</a>. The expected convention is that <span class="code">argv[0]</span> will contain the program name, but FORFILES  instead passes the first <i>argument</i> as <span class="code">argv[0]</span>. Old versions e.g. FORFILES version 1.46 (24th March 2006) do not suffer from this bug.</p>
<p>One workaround for this is to include the program name as the first argument, this will be passed along by FORFILES and the CreateProcess call will then work as expected:<br>
<span class="code">FORFILES /c "Ping Ping -a"</span></p>
<p>Alternatively pass the command to <a href="cmd.html"><span class="code">CMD /C</span></a>, which will then process all the arguments correctly, if you want to use an internal commmand, or if you want to use redirection, pipe, command concatenation, etc, then you must use CMD /C.<br>
<span class="code">FORFILES /c "CMD /C Ping -a"</span></p>
<p>There are some disadvantages to using CMD.exe with FORFILES, a new process will be created and destroyed for every file that FORFILES processes, so if you loop through 1000 files, then 1000 copies of CMD.exe will be opened and closed, this will affect performance. Also any variable created with <span class="code">SET</span> will be lost as soon as FORFILES moves on to the next file.</p>
<p>In most cases using a simple <a href="for2.html">FOR</a> command along with <a href="syntax-args.html">Parameter extensions</a> will provide a better/less buggy solution.<br>
</p>
</blockquote>
<h2>Return values</h2>
<blockquote>
<p>If ForFiles finds one or more matches if will return <a href="errorlevel.html">Errorlevel</a> =0<br>
If ForFiles finds no matches if will return Errorlevel =1 and will print<i> "ERROR: No files found with the specified search criteria."</i></p>
</blockquote>
<h2>Notes</h2>
<blockquote>
<p>Early versions of FORFILES were  supplied in the NT resource kits and  used unix style '-' parameters,
(still supported for backwards compatibility) also the /D option  accepted dates only in <span class="code">DDMMYYYYHHMN</span> format.</p>
<p>Last modified dates set in the future are not common but can happen when your computer clock date/time is changed e.g. due to daylight savings time. </p>
</blockquote>
<p><b>Examples:</b></p>
<p>Delete the testfile if it is is 5 days old or older:<br>
<span class="code">C:\&gt; forfiles /m testfile.txt /c "cmd /c Del testfile.txt " /d -5</span></p>
<p>Find .xls file that were last modified 30 days ago or older <br>
<span class="code">C:\&gt; FORFILES /M *.xls /C "cmd /c echo @path was changed 30 days ago" /D -30 </span></p>
<p>List the size of all .doc files:<br>
<span class="code"> C:\&gt; FORFILES /S /M *.doc /C "cmd /c echo @fsize" </span></p>
<p><i class="quote">Rule #1: Don’t sweat the small stuff. <br>
Rule #2: It's all small stuff - Dr Robert S Eliot, University of Nebraska cardiologist</i><br>
<br>
<b>Related:</b></p>
<p>Syntax - <a href="syntax-delolder.html">Delete files older than <i>N </i>days</a><br>
<a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/08/03/10334560.aspx" target="_blank" rel="external">OldNewThing</a> - Combining ForFiles and FOR <br>
<a href="syntax-args.html">Parameter extensions</a> - Get  file size(s).<br>
<a href="for.html">FOR</a> - Conditionally perform a command several times.<br>
Powershell:  <a href="../ps/foreach-object.html">ForEach-Object</a> - Loop for each object in the pipeline<br>
Equivalent bash command (Linux): <a href="../bash/find.html">find</a> - Search for files that meet a desired criteria</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p>
<!-- windows300 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="7649547908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id="bl" class="footer"><a href="forfiles.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2016<br>
Some rights reserved</div><!-- #EndLibraryItem -->

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/nt/forfiles.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>