<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="New-Object 
Create an instance of a .Net or COM object. This allows you to startup and control other applications (including VBScript) from PowerShell. 
Syntax
      New-Object [-comObject] string[] [">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/ps/new-object.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="New-Object 
Create an instance of a .Net or COM object. This allows you to startup and control other applications (including VBScript) from PowerShell. 
Syntax
      New-Object [-comObject] string[] [">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:00:38.046Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="New-Object 
Create an instance of a .Net or COM object. This allows you to startup and control other applications (including VBScript) from PowerShell. 
Syntax
      New-Object [-comObject] string[] [">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_ps.lbi" --><!-- #EndLibraryItem --><h1>New-Object</h1> 
<p>Create an instance of a .Net or COM object. This allows you to startup and control other applications (including VBScript) from PowerShell. </p>
<pre>Syntax
      New-Object [-comObject] <i>string</i>[] [-strict]  
            [-Property <i>hashtable</i>] [<i>CommonParameters</i>]
<pre><code>  New-Object [-typeName] &lt;i&gt;string&lt;/i&gt;[] [[-argumentList] &lt;i&gt;Object[]&lt;/i&gt;]
        [-Property &lt;i&gt;hashtable&lt;/i&gt;] [&lt;i&gt;CommonParameters&lt;/i&gt;]
</code></pre>
<p>Key<br>
-argumentList <i>Object</i><br>
A comma separated list of arguments to pass to the constructor of the .Net class.</p>
<p>-comObject <i>string</i><br>
Programmatic Identifier (ProgID) of the COM object.</p>
<p>-Property <i>hashtable<br></i>       Set property values and invokes methods of the new object.</p>
<pre><code>   Enter a hash table in which the keys are the names of properties or methods and
   the values are property values or method arguments. New-Object creates the object and
   sets each property value and invokes each method in the order that they appear in the hash table.

   If the new object is derived from the PSObject class, a property is specified that
   does not exist on the object, it will be added to the object as a NoteProperty.
   If the object is not a PSObject, the command generates a non-terminating error.
</code></pre>
<p>-strict<br>
Raise an error if the COM object that you attempt to<br>
create uses an interop assembly.<br>
This enables you to distinguish actual COM objects from<br>
.Net objects with COM-callable wrappers.</p>
<p>-typeName <i>string</i><br>
The fully-qualified name of the .Net class.</p>
<p><a href="common.html">CommonParameters</a>:<br>
-Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,<br>
-OutBuffer -OutVariable.</p></pre><p></p>
<p><b>Examples</b></p>
<p><a id="speech"></a>Speak a sentence:</p>
<p class="code">PS C:\&gt; Add-Type -AssemblyName System.Speech<br>
$say = New-Object -TypeName System.Speech.Synthesis.SpeechSynthesizer<br>
$say.Speak('SS64 taught me everything.')</p>
<p>Open MS Word, create a COM object "Word.Application" and store the resulting reference in a variable:</p>
<p class="code">PS C:\&gt; $objWord=<b>new-object</b> -comobject Word.Application<br>
$objWord.visible=$true</p>
<p>Create a <a href="../vb/index.html">VBScript</a> COM object, start MS Word and type in some text using SendKeys: </p>
<pre>$objVBscript = <b>new-object</b> -comobject wscript.shell
[void] $objVBscript.<a href="../vb/popup.html">popup</a>("This is VBScript",0,"SS64 MsgBox",1)
<p>[void] $objVBscript.<a href="../vb/run.html">Run</a>(“Winword.exe”)<br>
Start-sleep 3</p></pre><p></p>
<pre>If ($objVBscript.<a href="../vb/appactivate.html">AppActivate</a>("Microsoft Word"))
{
  Start-sleep 2
  $objVBscript.<a href="../vb/sendkeys.html">SendKeys</a>("Hello 123")
}</pre>
<p>Create a COM object "Shell.Application" and store the resulting reference in a variable, display the properties and methods of the COM object (via get-member.) Then use the ToggleDesktop method to minimize all open desktop windows:</p>
<p><span class="code">PS C:\&gt; $objShell = <b>new-object</b> -comobject "Shell.Application"<br>
$objShell | get-member<br>
$objShell.ToggleDesktop()</span></p>
<p>Send email:</p>
<p class="code"># Instantiate an SmtpClient object<br>
$objMailClient = <b>new-object</b> Net.Mail.SmtpClient -arg "mailserver.example.com" </p>
<p class="code"># Instantiate a new MailMessage object, with sender, destination,subject and body<br>
$objMessage = <b>new-object</b> Net.Mail.MailMessage("me@example.com","you@example.com", "Subject", "Here is some email")</p>
<p class="code"># Add an attachment to the message<br>
$objAttach = <b>new-object</b> Net.Mail.Attachment("c:\\demo.txt")<br>
$objMessage.Attachments.Add($objAttach)</p>
<p class="code"># Send the message object using the email client <br>
$objMailClient.Send($objMessage)</p>
<p>Install fonts from local path <span class="code">:<br>
<br>
$FONTS = 0x14 <br>
$objShell = New-Object -ComObject Shell.Application <br>
$objFolder = $objShell.Namespace($FONTS) <br>
$objFolder.CopyHere("C:\tempfiles\ITCBLKAD.TTF")</span></p>
<p>For more examples, type: "get-help New-Object -detailed"</p>
<p class="quote"><i>“The creation of a thousand forests is in one acorn” ~ Ralph Waldo Emerson </i></p>
<p><b>Related:</b></p>
<p><a href="compare-object.html">Compare-Object</a> - Compare the properties of objects<br>
<a href="foreach-object.html">ForEach-Object</a> - Loop for each object in the pipeline<br>
<a href="group-object.html">Group-Object</a> - Group the objects that contain the same value for a common property<br>
<span class="body"><a href="measure-object.html">Measure-Object</a> - Measure aspects of object properties and create objects from those values<br>
<p><a href="select-object.html">Select-Object</a> - Select objects based on parameters set in the Cmdlet command string<br><br>
<a href="sort-object.html">Sort-Object</a> - Sort the input objects by property value<br><br>
<a href="tee-object.html">Tee-Object</a> - Send input objects to two places<br><br>
<a href="where-object.html">Where-Object</a> - Filter input from the pipeline allowing operation on only certain objects<br><br>
OS X Equivalent: <a href="../osx/say.html">say</a> - Convert text to audible speech.</p></span></p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p></p>
<!-- PowerShell300 -->
<p><ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="6253539900"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script><p></p>
<hr>
<div id="bl" class="footer"><a href="new-object.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2015<br>
Some rights reserved</div><!-- #EndLibraryItem -->

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/ps/new-object.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>