<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="PsExec (PsTools)
Execute a command-line process on a remote machine. 
Syntax
      psexec \\computer[,computer[,..] [options] command [arguments]
  psexec @&amp;lt;i&amp;gt;run_file &amp;lt;/i&amp;gt;[&amp;lt;i&amp;gt;option">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/nt/psexec.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="PsExec (PsTools)
Execute a command-line process on a remote machine. 
Syntax
      psexec \\computer[,computer[,..] [options] command [arguments]
  psexec @&amp;lt;i&amp;gt;run_file &amp;lt;/i&amp;gt;[&amp;lt;i&amp;gt;option">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:02:53.183Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="PsExec (PsTools)
Execute a command-line process on a remote machine. 
Syntax
      psexec \\computer[,computer[,..] [options] command [arguments]
  psexec @&amp;lt;i&amp;gt;run_file &amp;lt;/i&amp;gt;[&amp;lt;i&amp;gt;option">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_nt.lbi" --><!-- #EndLibraryItem --><h1>PsExec (<abbr title="Download the PsTools suite"><a href="http://technet.microsoft.com/en-us/sysinternals" target="_blank" rel="external">PsTools</a></abbr>)</h1>
<p>Execute a command-line process on a remote machine. </p>
<pre>Syntax
      psexec \\<i>computer</i>[,<i>computer</i>[,..] [<i>options</i>] <i>command</i> [<i>arguments</i>]
<pre><code>  psexec @&lt;i&gt;run_file &lt;/i&gt;[&lt;i&gt;options&lt;/i&gt;] &lt;i&gt;command&lt;/i&gt; [&lt;i&gt;arguments&lt;/i&gt;]
</code></pre>
<p>Options:</p>
<p><i>computer</i>   The computer on which psexec will run <i>command</i>. Default = local system<br>
To run against all computers in the current domain enter “\*”</p>
<p>@<i>run_file</i>  Run <i>command</i> on every computer listed in the text file specified.</p>
<p><i>command</i>    Name of the program to execute</p>
<p><i>arguments</i>  Arguments to pass (file paths must be absolute paths on the target system)</p>
<p>-a <i>n</i>,<i>n</i>,… Set processor affinity to <i>n</i>. Processors are numbered as 1,2,3,4 etc<br>
so to run the application on CPU 2 and CPU 4, enter: “-a 2,4”</p>
<p>-c         Copy the program (<i>command</i>)to the remote system for execution.<br>
-c -f      Copy even if the file already exists on the remote system.<br>
-c -v      Copy only if the file is a higher version or is newer than the remote copy.</p>
<p>If you omit the -c option then the application must be in the system path on the remote system.</p>
<p>-d         Don’t wait for the application to terminate.<br>
Only use for non-interactive applications.</p>
<p>-e         Do NOT load the specified account’s profile.<br>
(In early versions of PSEXEC: Load the user account’s profile, don’t use with -s)</p>
<p>-f         Copy the specified program even if the file already exists on the remote system.</p>
<p>-h         Run with the account’s <a href="syntax-elevate.html">elevated token</a>, if available. (Vista or higher)</p>
<p>-i         Interactive - Run the program so that it interacts with the desktop on the remote system.<br>
If no session is specified, the process runs in the console session.</p>
<p>-l         Limited - Run process as limited user.  Run with Low Integrity.<br>
Strips the Administrators group and allows only privileges assigned to the Users group.</p>
<p>-n <i>s</i>       Specify a timeout (<i>s</i> seconds) for connecting to the remote computer.</p>
<p>-p <i>psswd</i>   Specify a password for <i>user</i> (optional). Passed as clear text.<br>
If omitted, you will be prompted to enter a hidden password.</p>
<p>-r         The name of the remote service to create or interact with.</p>
<p>-s         Run remote process in the SYSTEM account (use with caution).</p>
<p>-u <i>user</i>    Specify a user name for login to remote computer(optional).</p>
<p>-v         Copy the specified file only if it has a higher version number or is newer<br>
than the one on the remote system.</p>
<p>-w <i>directory</i> Set the working directory of the process (relative to the remote computer).</p>
<p>-x         Display the UI on the Winlogon desktop (local system only).</p>
<p>-low, -belownormal, -abovenormal, -high or -realtime<br>
These options will run the process at a different priority.<br>
also -background (Vista and above) will run at low memory and I/O priority.</p>
<p>-accepteula Suppress the display of the license dialog.</p></pre><p></p>
<p>  For PsExec to work, <i>File and Printer sharing</i> must  be enabled on the remote computer.</p>
<p>PsExec can also be used to start GUI applications, but in that case the GUI will appear on the remote machine. </p>
<p>Input is  passed to the remote system when you press the enter key -  typing Ctrl-C will terminate the remote process.</p>
<p>When you specify a <b>username </b>the remote process will execute in that account, and will have access to that account's network resources. </p>
<p>If you omit <b>username </b>the remote process will run in the same account from which you execute PsExec, but because the remote process is impersonating it will not have access to network resources on the remote system. </p>
<p>If you do specify an alternative username/password, then PsExec will send the password in clear text. This can be a security risk if unauthorized network sniffers could intercept traffic between the local and remote system.</p>
<p>PsExec does not require you to be an administrator of the local filesystem, with the correct password psexec will allow <i>UserA</i> to run commands as <i>UserB</i> - a <a href="runas.html">Runas</a> replacement.</p>
<p>If you kill a PsExec process, you might also need to manually remove the background service:<br>
<span class="code">sc.exe \\workstation64 delete psexesvc</span></p>
<p>PsExec can also be used to start a process (on a remote or local machine) as SYSTEM, this is a very privileged account similar to root on a UNIX machine ~ use with extreme caution.</p>
<h2>Accept eula</h2>
<p>When launched for the first time, PsExec will create the license registry key:<br>
<span class="code">HKCU\Software\Sysinternals\PsExec\EulaAccepted=0x01</span></p>
<p>Psexec will swallow the first "-accepteula" on the commandline, no matter where it occurs, so when using psexec to run any other ps* utilities, you will have to pass "-accepteula" twice:</p>
<p class="code">psexec -accepteula -s c:\utils\pslist.exe -accepteula</p>
<p>Surround any long filenames "with quotation marks"</p>
<p>Error <a href="errorlevel.html">codes</a> returned by PsExec are specific to the applications you execute, not PsExec.</p>
<h2>Internal commands</h2>
<p>Internal commands (such as COPY, CD, DIR  etc) are only available within the CMD shell. To run these commands from PsExec you must call <a href="cmd.html">CMD /C</a> and then pass the commands as parameters - see the examples below. <br>
<br>
<b>Examples:</b><br>
<br>
Launch an interactive command prompt on \\workstation64, the CMD prompt window will appear locally:</p>
<p class="code">psexec \\workstation64 cmd</p>
<p>Execute a program that is already installed on the remote system:</p>
<p class="code">psexec \\workstation64 "c:\Program Files\test.exe"</p>
<p>Connect to  workstation64 and run <a href="ipconfig.html">IPCONFIG</a> to display the remote PC's IP address:</p>
<p class="code">psexec \\workstation64 ipconfig</p>
<p>Connect to  workstation64 and list a directory:</p>
<p class="code">psexec \\workstation64 -s cmd /c dir c:\work</p>
<p>Connect to workstation64 and copy a file from another server:</p>
<p class="code">psexec \\workstation64 -s cmd /c copy \\server21\share45\file.ext c:\localpath</p>
<p>Execute IpConfig on the remote system, and display the output locally:</p>
<p class="code">psexec \\workstation64 ipconfig /all</p>
<p>Copy the program test.exe to the remote system and execute it interactively, running under the account DannyGlover:</p>
<p class="code">psexec \\workstation64 -c test.exe -u DannyGlover -p Pa55w0rd </p>
<p>Run Internet Explorer on the local machine but with limited-user privileges:</p>
<p class="code">psexec -l -d "c:\program files\internet explorer\iexplore.exe"</p>
<p>Run Regedit on the local machine with SYSTEM privileges:</p>
<p class="code">psexec -s -i regedit.exe</p>
<p>From PowerShell, run a VBscript on a remote workstation and pass some parameters:</p>
<p class="code">PS C:&gt; $script='C:\Program Files\demo.vbs'<br>
PS C:&gt; $args = "some more text"<br> 
PS C:&gt; psexec -s \\workstation64 c:\windows\system32\cscript.exe $script $args</p>
<p class="quote"><i>“Don’t ask what the world needs. Ask what makes you come alive, and go do it. Because what the world needs is people who have come alive” - Howard Thurman</i></p>
<p><b>Related:</b></p>
<p><a href="http://forum.sysinternals.com/faq-common-pstools-issues_topic15920.html" target="_blank" rel="external">FAQ: Common PSTools Issues</a><br>
<a href="https://support.microsoft.com/kb/942817" target="_blank" rel="external">Q942817</a> - Remote UAC <span class="code">LocalAccountTokenFilterPolicy</span> setting (allow remote administration for Vista/Windows7)<br>
<a href="runas.html">RUNAS</a> - Execute a program under a different user account<br>
<a href="../links/windows.html#utils">xCMD</a> - 3rd party utility<br>
Equivalent PowerShell command: <a href="../ps/invoke-command.html">Invoke-Command</a><br>
Equivalent bash command (Linux): xon - start an X program on a remote machine</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p>
<!-- windows300 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="7649547908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id="bl" class="footer"><a href="psexec.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2016<br>
Some rights reserved</div><!-- #EndLibraryItem -->

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/nt/psexec.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>