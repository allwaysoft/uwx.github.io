<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="A place for random garbage." />
  

  
  
  
  
  
  
  <title>
    
      Chris Hansen&#39;s Nut Shack
    </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="WEVTUTIL (Vista and above) 
 Retrieve information about event logs and publishers. Archive logs in a self-contained format, Enumerate the available logs, Install and uninstall event manifests,  run qu">
<meta property="og:type" content="website">
<meta property="og:title" content="Chris Hansen's Nut Shack">
<meta property="og:url" content="http://rafa1231518.github.io/nt/wevtutil.html">
<meta property="og:site_name" content="Chris Hansen's Nut Shack">
<meta property="og:description" content="WEVTUTIL (Vista and above) 
 Retrieve information about event logs and publishers. Archive logs in a self-contained format, Enumerate the available logs, Install and uninstall event manifests,  run qu">
<meta property="og:image" content="http://rafa1231518.github.io/../images/top.png">
<meta property="og:updated_time" content="2016-11-02T00:02:56.017Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chris Hansen's Nut Shack">
<meta name="twitter:description" content="WEVTUTIL (Vista and above) 
 Retrieve information about event logs and publishers. Archive logs in a self-contained format, Enumerate the available logs, Install and uninstall event manifests,  run qu">
<meta name="twitter:image" content="http://rafa1231518.github.io/../images/top.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  
    <link rel="stylesheet" href="/css/style.css">
    <style type="text/css">
.header-anchor {
  display: none;
}
    </style>
  
  

  
  <!-- baidu webmaster push -->
  <!-- tracking
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
  -->

</head>
<body class="home blog custom-background custom-font-enabled single-author">
  
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Chris Hansen&#39;s Nut Shack" rel="home">Chris Hansen&#39;s Nut Shack</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Have a seat, right over there.</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pagelist">Tools &amp; Stuff</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        
          <div id="primary" class="site-content"><div id="content" role="main"><article id="page-undefined" class="page-undefined post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        <div class="comments-link">
            
            
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <!-- #BeginLibraryItem "/Library/head_nt.lbi" --><!-- #EndLibraryItem --><h1>WEVTUTIL (Vista and above) </h1>
<p> Retrieve information about event logs and publishers. Archive logs in a self-contained format, Enumerate the available logs, Install and uninstall event manifests,  run queries,   
Exports events (from an event log, from a log file, or using a structured query) to a specified file,
Clear event logs.
</p><pre>Syntax
      wevtutil [{al | archive-log} <i>Logpath</i> [/l:<i>Locale</i>]]
        [{cl | clear-log} <i>Logname</i> [/bu:<i>Backup</i>]] [/r:<i>Remote</i>] [/u:<i>Username</i>] [/p:<i>Password</i>] [/a:&lt;Auth&gt;] [/uni:&lt;Unicode&gt;]
          [{el | enum-logs}] [{gl | get-log} <i>Logname</i> [/f:<i>Format</i>]]
             [{epl | export-log} <i>Path</i> <i>Exportfile</i> [/lf:<i>Logfile</i>] [/sq:<i>Structquery</i>] [/q:<i>Query</i>] [/ow:<i>Overwrite</i>]]
                [{ep | enum-publishers}]
                   [{gli | get-loginfo} <i>Logname</i> [/lf:<i>Logfile</i>]]
                      [{gp | get-publisher} <i>Publishername</i> [/ge:<i>Metadata</i>] [/gm:<i>Message</i>] [/f:<i>Format</i>]] [{im | install-manifest} <i>Manifest</i>]
                         [{qe | query-events} <i>Path </i>[/lf:<i>Logfile</i>] [/sq:<i>Structquery</i>] [/q:<i>Query</i>] [/bm:<i>Bookmark</i>]
                                  [/sbm:<i>Savebm</i>] [/rd:<i>Direction</i>] [/f:<i>Format</i>] [/l:<i>Locale</i>] [/c:<i>Count</i>] [/e:<i>Element</i>]]
                            [{sl | set-log} <i>Logname</i> [/e:<i>Enabled</i>] [/i:<i>Isolation</i>] [/lfn:<i>Logpath</i>] [/rt:<i>Retention</i>]
                                     [/ab:<i>Auto</i>] [/ms:<i>Size</i>] [/l:<i>Level</i>] [/k:<i>Keywords</i>] [/ca:<i>Channel</i>] [/c:<i>Config</i>]]
                               [{um | uninstall-manifest} <i>Manifest</i>]
<p>Key<br>
/f:<i>Format</i>     The output format, either XML or text format. If &lt;Format&gt; is XML,<br>
the output is displayed in XML format. If &lt;Format&gt; is Text, the output is<br>
displayed without XML tags. The default is Text.<br>
/e:<i>Enabled</i>    Enable or disable a log. <i>Enabled</i> can be true or false.<br>
/i:<i>Isolation</i>  Set the log isolation mode. <i>Isolation</i> can be system, application or custom.<br>
The isolation mode of a log determines whether a log shares a session with other<br>
logs in the same isolation class. If you specify system isolation, the target log<br>
will share at least write permissions with the System log. If you specify application<br>
isolation, the target log will share at least write permissions with the Application log.<br>
If you specify custom isolation, you must also provide a security descriptor<br>
by using the /ca option.<br>
/lfn:<i>Logpath  </i>Define the log file name. <i>Logpath</i> is a full path to the file where the Event<br>
Log service stores events for this log.<br>
/rt:<i>Retention</i> Set the log retention mode. <i>Retention</i> can be true or false.<br>
The log retention mode determines the behavior of the Event Log service when a log<br>
reaches its maximum size. If an event log reaches its maximum size and the log retention<br>
mode is true, existing events are retained and incoming events are discarded.<br>
If the log retention mode is false, incoming events overwrite the oldest events in the log.<br>
/ab:<i>Auto</i>      The log auto-backup policy. <i>Auto</i> can be true or false. If this value is true,<br>
the log will be backed up automatically when it reaches the maximum size.<br>
If this value is true, the retention (specified with the /rt option)<br>
must also be set to true.<br>
/ms:<i>Size</i>      Set the maximum size of the log in bytes.<br>
The minimum log size is 1048576 bytes (1024KB) and log files are always multiples of 64KB,<br>
so the value you enter will be rounded off accordingly.<br>
/l:<i>Level</i>      Define the level filter of the log. <i>Level</i> can be any valid level value.<br>
This option is only applicable to logs with a dedicated session.<br>
You can remove a level filter by setting <i>Level</i> to 0.<br>
/k:<i>Keywords</i>   Add a keyword filter to the log. <i>Keywords</i> can be any valid 64 bit keyword mask.<br>
This option is only applicable to logs with a dedicated session.<br>
/ca:<i>Channel   </i>Set the access permission for an event log. <i>Channel</i> is a security descriptor<br>
that uses the Security Descriptor Definition Language (SDDL).<br>
/c:<i>Config</i>     The path to a configuration file.<br>
This option will cause log properties to be read from the configuration file<br>
defined in <i>Config</i>. If you use this option, you must not specify a &lt;Logname&gt; parameter.<br>
The log name will be read from the configuration file.<br>
/ge:<i>Metadata</i>  Get metadata information for events that can be raised by this publisher.<br>
<i>Metadata</i> can be true or false.<br>
/gm:<i>Message</i>   Display the actual message instead of the numeric message ID.<br>
<i>Message</i> can be true or false.<br>
/lf:<i>Logfile</i>   Read the events from a log or from a log file.<br>
<i>Logfile</i> can be true or false. If true, the parameter to the command is the path<br>
to a log file.<br>
/sq:<i>Structquery</i> Specifies that events should be obtained with a structured query.<br>
<i>Structquery</i> can be true or false. If true, &lt;Path&gt; is the path to a file that<br>
contains a structured query.<br>
/q:<i>Query</i>      Define the XPath query to filter the events that are read or exported.<br>
If this option is not specified, all events will be returned or exported.<br>
This option is not available when /sq is true.<br>
/bm:<i>Bookmark</i>  The path to a file that contains a bookmark from a previous query.<br>
/sbm:<i>Savebm</i>   The path to a file that is used to save a bookmark of this query.<br>
The file name extension should be .xml.<br>
/rd:<i>Direction</i> The direction in which events are read. <i>Direction</i> can be true or false.<br>
If true, the most recent events are returned first.<br>
/l:<i>Locale</i>     Define a locale string that is used to print event text in a specific locale.<br>
Only available when printing events in text format using the /f option.<br>
/c:<i>Count</i>      Sets the maximum number of events to read.<br>
/e:<i>Element</i>    Includes a root element when displaying events in XML. &lt;Element&gt; is the string<br>
that you want within the root element. For example, /e:root would result<br>
in XML that contains the root element pair &lt;root&gt;&lt;/root&gt;.<br>
/ow:<i>Overwrite</i> Specifies that the export file should be overwritten. <i>Overwrite</i> can<br>
be true or false. If true, and the export file specified in <i>Exportfile</i> already exists,<br>
it will be overwritten without confirmation.<br>
/bu:<i>Backup</i>    The path to a file where the cleared events will be stored.<br>
Include the .evtx extension in the name of the backup file.<br>
/r:<i>Remote</i>     Run the command on a remote computer. <i>Remote</i> is the name of the<br>
remote computer. The im and um parameters do not support remote operation.<br>
/u:<i>Username</i>   A different user to log on to a remote computer. &lt;Username&gt; is a<br>
user name in the form domain\user or user. This option is only applicable when<br>
the /r option is specified.<br>
/p:<i>Password</i>   The password for the user. If the /u option is used and<br>
this option is not specified or <i>Password</i> is “*”, the user will be prompted to enter<br>
a password. This option is only applicable when the /u option is specified.<br>
/a:<i>Auth</i>       The authentication type for connecting to a remote computer.<br>
<i>Auth</i> can be Default, <u>Negotiate</u>, Kerberos or NTLM. The default is Negotiate.<br>
/uni:<i>Unicode</i>  Displays the output in Unicode. <i>Unicode</i> can be true or false.<br>
If <i>Unicode</i> is true then the output is in Unicode.</p>
</pre>
<p>The primary focus of WEVTUTIL is the configuration and setup of event logs,  to retrieve event log data  the PowerShell cmdlet <a href="../ps/get-winevent.html">Get-WinEvent</a> is easier to use and more flexible.</p>
<p><b>Examples</b></p>
<p>Clear all the events from the Application log:<br>
<span class="code">C:\&gt; WEVTUtil.exe clear-log Application</span></p>
<p>Export events from the System log to C:\backup\ss64.evtx<br>
<span class="code">C:\&gt; WEVTUtil export-log System C:\backup\ss64.evtx</span></p>
<p>List the event publishers on the current computer.<br>
<span class="code">C:\&gt; WEVTUtil enum-publishers</span></p>
<p>Uninstall publishers and logs from the SS64.man manifest file:<br>
<span class="code">C:\&gt; WEVTUtil uninstall-manifest SS64.man</span></p>
<p>Find the last 20 startup events in the System log:<br>
</p>
<pre>C:\&gt; WEVTUtil query-events System /count:20 /rd:true /format:text /q:"Event[System[(EventID=12)]]" 
</pre>
<p class="quote"><i>"The Statesman who yields to war fever must realize that once the signal is given, he is no longer the master of policy but the slave of unforeseeable and uncontrollable events" ~ Sir Winston Spencer Churchill</i></p>
<p><b>Related:<br>
<br>
</b><a href="eventcreate.html">EVENTCREATE</a> - Add a message to the Windows event log<br>
<a href="sysmon.html">SYSMON</a> - Monitor and log system activity to the Windows event log<br>
PowerShell: <a href="../ps/get-winevent.html">Get-WinEvent</a> -  Get event log data (Vista+)<br>
Powershell: <a href="../ps/get-eventlog.html">Get-Eventlog</a> - Get event log data (XP/2003)<br>
<a href="../ps/syntax-eventids.html">List of Windows Event IDs.</a><br>
<a href="wmic.html">WMIC NTEVENTLOG</a> - WMI access to the event log</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p>
<!-- windows300 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6140977852749469" data-ad-slot="7649547908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id="bl" class="footer"><a href="wevtutil.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id="br" class="footer, tagline">© Copyright <a href="http://ss64.com/" target="_blank" rel="external">SS64.com</a> 1999-2016<br>
Some rights reserved</div><!-- #EndLibraryItem -->

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    Posted at <a href="/nt/wevtutil.html">
    <time datetime="2016-09-04T22:26:55.000Z" class="entry-date">
        2016-09-04
    </time>
</a> (click date for permalink).
    
    
    </footer>
</article>


    






</div></div>
          <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="Search" />
    </div>
</form></aside>
  
    
  
    
  
    
  
    
  
    
  
</div>
        
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2016 chrishansen69 (rafa1231518).
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wizardforcel/hexo-theme-cyanstyle">Wizard Zhang (wizardforcel)</a></p>
</footer>
    <!-- tracking
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
-->

<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
  
</body>
</html>