(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("smarty",function(t,r){var i=r.rightDelimiter||"}";var n=r.leftDelimiter||"{";var a=r.version||2;var o=e.getMode(t,r.baseMode||"null");var l=["debug","extends","function","include","literal"];var f={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};var u;function s(e,t){u=t;return e}function d(e,t,r){t.tokenize=r;return r(e,t)}function c(e,t){if(t==null)t=e.pos;return a===3&&n=="{"&&(t==e.string.length||/\s/.test(e.string.charAt(t)))}function p(e,t){var r=e.string;for(var a=e.pos;;){var l=r.indexOf(n,a);a=l+n.length;if(l==-1||!c(e,l+n.length))break}if(l==e.pos){e.match(n);if(e.eat("*")){return d(e,t,b("comment","*"+i))}else{t.depth++;t.tokenize=h;u="startTag";return"tag"}}if(l>-1)e.string=r.slice(0,l);var f=o.token(e,t.base);if(l>-1)e.string=r;return f}function h(e,t){if(e.match(i,true)){if(a===3){t.depth--;if(t.depth<=0){t.tokenize=p}}else{t.tokenize=p}return s("tag",null)}if(e.match(n,true)){t.depth++;return s("tag","startTag")}var r=e.next();if(r=="$"){e.eatWhile(f.validIdentifier);return s("variable-2","variable")}else if(r=="|"){return s("operator","pipe")}else if(r=="."){return s("operator","property")}else if(f.stringChar.test(r)){t.tokenize=v(r);return s("string","string")}else if(f.operatorChars.test(r)){e.eatWhile(f.operatorChars);return s("operator","operator")}else if(r=="["||r=="]"){return s("bracket","bracket")}else if(r=="("||r==")"){return s("bracket","operator")}else if(/\d/.test(r)){e.eatWhile(/\d/);return s("number","number")}else{if(t.last=="variable"){if(r=="@"){e.eatWhile(f.validIdentifier);return s("property","property")}else if(r=="|"){e.eatWhile(f.validIdentifier);return s("qualifier","modifier")}}else if(t.last=="pipe"){e.eatWhile(f.validIdentifier);return s("qualifier","modifier")}else if(t.last=="whitespace"){e.eatWhile(f.validIdentifier);return s("attribute","modifier")}if(t.last=="property"){e.eatWhile(f.validIdentifier);return s("property",null)}else if(/\s/.test(r)){u="whitespace";return null}var o="";if(r!="/"){o+=r}var d=null;while(d=e.eat(f.validIdentifier)){o+=d}for(var c=0,h=l.length;c<h;c++){if(l[c]==o){return s("keyword","keyword")}}if(/\s/.test(r)){return null}return s("tag","tag")}}function v(e){return function(t,r){var i=null;var n=null;while(!t.eol()){n=t.peek();if(t.next()==e&&i!=="\\"){r.tokenize=h;break}i=n}return"string"}}function b(e,t){return function(r,i){while(!r.eol()){if(r.match(t)){i.tokenize=p;break}r.next()}return e}}return{startState:function(){return{base:e.startState(o),tokenize:p,last:null,depth:0}},copyState:function(t){return{base:e.copyState(o,t.base),tokenize:t.tokenize,last:t.last,depth:t.depth}},innerMode:function(e){if(e.tokenize==p)return{mode:o,state:e.base}},token:function(e,t){var r=t.tokenize(e,t);t.last=u;return r},indent:function(t,r){if(t.tokenize==p&&o.indent)return o.indent(t.base,r);else return e.Pass},blockCommentStart:n+"*",blockCommentEnd:"*"+i}});e.defineMIME("text/x-smarty","smarty")});