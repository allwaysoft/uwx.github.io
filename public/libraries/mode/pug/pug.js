(function(t){if(typeof exports=="object"&&typeof module=="object")t(require("../../lib/codemirror"),require("../javascript/javascript"),require("../css/css"),require("../htmlmixed/htmlmixed"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../javascript/javascript","../css/css","../htmlmixed/htmlmixed"],t);else t(CodeMirror)})(function(t){"use strict";t.defineMode("pug",function(e){var i="keyword";var n="meta";var r="builtin";var a="qualifier";var s={"{":"}","(":")","[":"]"};var u=t.getMode(e,"javascript");function c(){this.javaScriptLine=false;this.javaScriptLineExcludesColon=false;this.javaScriptArguments=false;this.javaScriptArgumentsDepth=0;this.isInterpolating=false;this.interpolationNesting=0;this.jsState=t.startState(u);this.restOfLine="";this.isIncludeFiltered=false;this.isEach=false;this.lastTag="";this.scriptType="";this.isAttrs=false;this.attrsNest=[];this.inAttributeName=true;this.attributeIsType=false;this.attrValue="";this.indentOf=Infinity;this.indentToken="";this.innerMode=null;this.innerState=null;this.innerModeForLine=false}c.prototype.copy=function(){var e=new c;e.javaScriptLine=this.javaScriptLine;e.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon;e.javaScriptArguments=this.javaScriptArguments;e.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth;e.isInterpolating=this.isInterpolating;e.interpolationNesting=this.interpolationNesting;e.jsState=t.copyState(u,this.jsState);e.innerMode=this.innerMode;if(this.innerMode&&this.innerState){e.innerState=t.copyState(this.innerMode,this.innerState)}e.restOfLine=this.restOfLine;e.isIncludeFiltered=this.isIncludeFiltered;e.isEach=this.isEach;e.lastTag=this.lastTag;e.scriptType=this.scriptType;e.isAttrs=this.isAttrs;e.attrsNest=this.attrsNest.slice();e.inAttributeName=this.inAttributeName;e.attributeIsType=this.attributeIsType;e.attrValue=this.attrValue;e.indentOf=this.indentOf;e.indentToken=this.indentToken;e.innerModeForLine=this.innerModeForLine;return e};function f(t,e){if(t.sol()){e.javaScriptLine=false;e.javaScriptLineExcludesColon=false}if(e.javaScriptLine){if(e.javaScriptLineExcludesColon&&t.peek()===":"){e.javaScriptLine=false;e.javaScriptLineExcludesColon=false;return}var i=u.token(t,e.jsState);if(t.eol())e.javaScriptLine=false;return i||true}}function o(t,e){if(e.javaScriptArguments){if(e.javaScriptArgumentsDepth===0&&t.peek()!=="("){e.javaScriptArguments=false;return}if(t.peek()==="("){e.javaScriptArgumentsDepth++}else if(t.peek()===")"){e.javaScriptArgumentsDepth--}if(e.javaScriptArgumentsDepth===0){e.javaScriptArguments=false;return}var i=u.token(t,e.jsState);return i||true}}function l(t){if(t.match(/^yield\b/)){return"keyword"}}function p(t){if(t.match(/^(?:doctype) *([^\n]+)?/)){return n}}function h(t,e){if(t.match("#{")){e.isInterpolating=true;e.interpolationNesting=0;return"punctuation"}}function d(t,e){if(e.isInterpolating){if(t.peek()==="}"){e.interpolationNesting--;if(e.interpolationNesting<0){t.next();e.isInterpolating=false;return"punctuation"}}else if(t.peek()==="{"){e.interpolationNesting++}return u.token(t,e.jsState)||true}}function m(t,e){if(t.match(/^case\b/)){e.javaScriptLine=true;return i}}function v(t,e){if(t.match(/^when\b/)){e.javaScriptLine=true;e.javaScriptLineExcludesColon=true;return i}}function S(t){if(t.match(/^default\b/)){return i}}function g(t,e){if(t.match(/^extends?\b/)){e.restOfLine="string";return i}}function j(t,e){if(t.match(/^append\b/)){e.restOfLine="variable";return i}}function b(t,e){if(t.match(/^prepend\b/)){e.restOfLine="variable";return i}}function L(t,e){if(t.match(/^block\b *(?:(prepend|append)\b)?/)){e.restOfLine="variable";return i}}function A(t,e){if(t.match(/^include\b/)){e.restOfLine="string";return i}}function y(t,e){if(t.match(/^include:([a-zA-Z0-9\-]+)/,false)&&t.match("include")){e.isIncludeFiltered=true;return i}}function k(t,e){if(e.isIncludeFiltered){var i=C(t,e);e.isIncludeFiltered=false;e.restOfLine="string";return i}}function x(t,e){if(t.match(/^mixin\b/)){e.javaScriptLine=true;return i}}function M(t,e){if(t.match(/^\+([-\w]+)/)){if(!t.match(/^\( *[-\w]+ *=/,false)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0}return"variable"}if(t.match(/^\+#{/,false)){t.next();e.mixinCallAfter=true;return h(t,e)}}function T(t,e){if(e.mixinCallAfter){e.mixinCallAfter=false;if(!t.match(/^\( *[-\w]+ *=/,false)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0}return true}}function I(t,e){if(t.match(/^(if|unless|else if|else)\b/)){e.javaScriptLine=true;return i}}function N(t,e){if(t.match(/^(- *)?(each|for)\b/)){e.isEach=true;return i}}function w(t,e){if(e.isEach){if(t.match(/^ in\b/)){e.javaScriptLine=true;e.isEach=false;return i}else if(t.sol()||t.eol()){e.isEach=false}else if(t.next()){while(!t.match(/^ in\b/,false)&&t.next());return"variable"}}}function O(t,e){if(t.match(/^while\b/)){e.javaScriptLine=true;return i}}function E(t,e){var i;if(i=t.match(/^(\w(?:[-:\w]*\w)?)\/?/)){e.lastTag=i[1].toLowerCase();if(e.lastTag==="script"){e.scriptType="application/javascript"}return"tag"}}function C(i,n){if(i.match(/^:([\w\-]+)/)){var r;if(e&&e.innerModes){r=e.innerModes(i.current().substring(1))}if(!r){r=i.current().substring(1)}if(typeof r==="string"){r=t.getMode(e,r)}K(i,n,r);return"atom"}}function F(t,e){if(t.match(/^(!?=|-)/)){e.javaScriptLine=true;return"punctuation"}}function D(t){if(t.match(/^#([\w-]+)/)){return r}}function V(t){if(t.match(/^\.([\w-]+)/)){return a}}function q(t,e){if(t.peek()=="("){t.next();e.isAttrs=true;e.attrsNest=[];e.inAttributeName=true;e.attrValue="";e.attributeIsType=false;return"punctuation"}}function z(e,i){if(i.isAttrs){if(s[e.peek()]){i.attrsNest.push(s[e.peek()])}if(i.attrsNest[i.attrsNest.length-1]===e.peek()){i.attrsNest.pop()}else if(e.eat(")")){i.isAttrs=false;return"punctuation"}if(i.inAttributeName&&e.match(/^[^=,\)!]+/)){if(e.peek()==="="||e.peek()==="!"){i.inAttributeName=false;i.jsState=t.startState(u);if(i.lastTag==="script"&&e.current().trim().toLowerCase()==="type"){i.attributeIsType=true}else{i.attributeIsType=false}}return"attribute"}var n=u.token(e,i.jsState);if(i.attributeIsType&&n==="string"){i.scriptType=e.current().toString()}if(i.attrsNest.length===0&&(n==="string"||n==="variable"||n==="keyword")){try{Function("","var x "+i.attrValue.replace(/,\s*$/,"").replace(/^!/,""));i.inAttributeName=true;i.attrValue="";e.backUp(e.current().length);return z(e,i)}catch(r){}}i.attrValue+=e.current();return n||true}}function U(t,e){if(t.match(/^&attributes\b/)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0;return"keyword"}}function Z(t){if(t.sol()&&t.eatSpace()){return"indent"}}function $(t,e){if(t.match(/^ *\/\/(-)?([^\n]*)/)){e.indentOf=t.indentation();e.indentToken="comment";return"comment"}}function B(t){if(t.match(/^: */)){return"colon"}}function G(t,e){if(t.match(/^(?:\| ?| )([^\n]+)/)){return"string"}if(t.match(/^(<[^\n]*)/,false)){K(t,e,"htmlmixed");e.innerModeForLine=true;return P(t,e,true)}}function H(t,e){if(t.eat(".")){var i=null;if(e.lastTag==="script"&&e.scriptType.toLowerCase().indexOf("javascript")!=-1){i=e.scriptType.toLowerCase().replace(/"|'/g,"")}else if(e.lastTag==="style"){i="css"}K(t,e,i);return"dot"}}function J(t){t.next();return null}function K(i,n,r){r=t.mimeModes[r]||r;r=e.innerModes?e.innerModes(r)||r:r;r=t.mimeModes[r]||r;r=t.getMode(e,r);n.indentOf=i.indentation();if(r&&r.name!=="null"){n.innerMode=r}else{n.indentToken="string"}}function P(e,i,n){if(e.indentation()>i.indentOf||i.innerModeForLine&&!e.sol()||n){if(i.innerMode){if(!i.innerState){i.innerState=i.innerMode.startState?t.startState(i.innerMode,e.indentation()):{}}return e.hideFirstChars(i.indentOf+2,function(){return i.innerMode.token(e,i.innerState)||true})}else{e.skipToEnd();return i.indentToken}}else if(e.sol()){i.indentOf=Infinity;i.indentToken=null;i.innerMode=null;i.innerState=null}}function Q(t,e){if(t.sol()){e.restOfLine=""}if(e.restOfLine){t.skipToEnd();var i=e.restOfLine;e.restOfLine="";return i}}function R(){return new c}function W(t){return t.copy()}function X(t,e){var i=P(t,e)||Q(t,e)||d(t,e)||k(t,e)||w(t,e)||z(t,e)||f(t,e)||o(t,e)||T(t,e)||l(t,e)||p(t,e)||h(t,e)||m(t,e)||v(t,e)||S(t,e)||g(t,e)||j(t,e)||b(t,e)||L(t,e)||A(t,e)||y(t,e)||x(t,e)||M(t,e)||I(t,e)||N(t,e)||O(t,e)||E(t,e)||C(t,e)||F(t,e)||D(t,e)||V(t,e)||q(t,e)||U(t,e)||Z(t,e)||G(t,e)||$(t,e)||B(t,e)||H(t,e)||J(t,e);return i===true?null:i}return{startState:R,copyState:W,token:X}},"javascript","css","htmlmixed");t.defineMIME("text/x-pug","pug");t.defineMIME("text/x-jade","pug")});